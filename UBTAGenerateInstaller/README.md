# Introduction 
The UBTAGenerateInstaller will automatically generate all necessary file for an UBTA Configuration Installer 
and it copies all used dependencies to YourInstaller\bin\TempInstallerFiles for the remote configuration.

# How does this work ? 
The UBTAGenerateInstaller uses the autogenerated files of your dependencies by using the Harvesting of WiX.Heat.exe

# Getting Started
You need to follow these steps for success:

1.	Add the [UBTAGenerateInstaller-Project](http://debre-tfs07.emea.thermo.com:8080/tfs/DefaultCollection/TEA%20UBTA%20Configurations/_git/UBTAGenerateInstaller) 
to your project solution. 
  
2.	Add a new project to your solution and choose the MSI Package(WiX v4).

3.	Delete all autogenerated .wxs and .wxl files from your installer project.

4.	Add the following snippet to YourInstaller.wixproj:
<pre><code>
<Project Sdk="WixToolset.Sdk/4.0.3">
  <Target Name="PreBuild" BeforeTargets="PreBuildEvent">
    <Exec Command="$(SolutionDir)\UBTAGenerateInstaller\bin\Debug\net6.0\UBTAGenerateInstaller.exe $(ProjectDir)" />
    //C:\Users\ardia\Desktop\Test\USB\POC\UBTAGenerateInstaller\UBTAGenerateInstaller\bin\Debug\net6.0
  </Target>
</Project>
</code></pre>

5. Change the Solution Platform of the project to x86, this is related to some libraries which the UBTA used.

6. Now your are ready for build, **keep in mind that during the initial process you need to build the installer 3 times**

7. Check if all wanted files are included in the Scripts_files.wxs and Connection_files.wxs
 
# Necessary Visual Studio Extentions:
- HeatWave for VS2022
- WiX v3 Toolset VS2022

# Troubleshooting hints:
1. Are autogenerated files in the following path? -> YourInstaller\obj\x86\Debug
2. If the post build event failed, make sure that YourInstaller\obj\x86\Debug\YourInstaller.wixproj.BindTracking-neutral.txt exists.
3. If a Dependency is not attached, maybe the fault is that the testconcept project has not the same name as the project folder.